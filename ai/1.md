# AI

当前项目为[chromasky-backend]
该项目为获取数据并计算火烧云指数的项目
比较混乱，但不用管，参考代码即可
已经考虑了下面条件：
语言: python3
如不清楚就按我的代码风格写
下面回答全部使用中文回答
我先将目前所有项目关键代码发你，你先理解并回答好即可

```bash
python ./ai/print_project_files.py . "\.(py|toml|md|html)$|Dockerfile$" -o ./ai/project_context.txt -e ".venv,.git,dist,build,.vscode,ai,README.md"
```

帮我取一个好一点的项目名字，包含chromasky，来用于 python 获取数据，处理数据，生成火烧云指数地图

## 计算火烧云指数

### 获取数据

从 GFS（过去数据集）中获取高云，中云，低云，总云量，降水，相对湿度
从 ECMWF（过去数据集） 中获取高云，中云，低云，总云量，降水，相对湿度

从 GFS（预测数据集） 中获取高云，中云，低云，总云量，降水，相对湿度


获取 AOD 数据

### 预处理数据

#### 确定搜索方向（高级）

确定搜索路径： 与你之前的方法一样，首先需要计算日出/日落时的太阳方位角（Azimuth）。这将是我们的搜索方向。
定义“有云”的阈值： GFS 给出的云量是百分比（0-100）。我们需要定义一个阈值来判断一个格点“有云”还是“无云”。例如，我们可以设定 Cloud_Threshold = 15%。当 HCDC 或 MCDC 的值大于这个阈值时，我们认为该点有云。这个阈值可以根据经验调整。
沿路径采样和搜索： 从你的观测点（lat, lon）开始，沿着太阳方位角的反方向（对于日落，就是朝向太阳的方向；对于日出，也是朝向太阳的方向），以固定的步长前进，检查每个采样点的云量。
识别边界： 我们要找的是“从有到无”的边界。这意味着我们需要找到路径上最后一个“有云”的点。

#### 分析不同气压层的相对湿度（高级）
这是推断所有云层（包括高、中、低云）位置和厚度的标准方法。
GFS 变量: RH (Relative Humidity)，在多个标准等压面上提供（例如 1000, 925, 850, 700, 500, 300, 250 hPa 等）。
原理: 云是在相对湿度接近或达到 100% 的地方形成的。因此，通过垂直扫描不同气压层的相对湿度，我们可以找到“高湿层”，这些高湿层就对应着云层所在的高度。
如何计算和使用:
获取垂直剖面数据: 对于你的目标位置（lat, lon），从 GFS 数据中提取出一系列垂直等压面上的相对湿度值。例如：RH@1000hPa, RH@925hPa, ..., RH@200hPa。
设定湿度阈值: 定义一个“成云”的相对湿度阈值。这个值通常不是 100%，因为 GFS 的分辨率有限，一个格点内的平均湿度可能没到100%但局部已经成云。常用阈值在 75% 到 95% 之间，可以根据经验调整。例如，我们设定 RH_Threshold = 85%。
扫描并识别云层:
从低到高（或从高到低）遍历所有气压层的 RH 值。
当 RH 值 首次 超过 RH_Threshold 时，记录下该层的高度/气压，这就是 第一层云的云底。
继续向上扫描，当 RH 值又掉回阈值以下，然后再一次超过阈值时，你就找到了 第二层云的云底。
重复这个过程，就可以找到所有可能存在的云层的高度。

### 验证数据集

- 2025-05-25	日落	卷云,卷层云	橘黄色,橘色	中到大烧	密卷云,乳状卷云
- 2025-05-28	日落	高层云,卷层云	橘黄色,橘色,橘红色	中到大烧	乳状卷层云,乳状高层云
- 2025-06-25	日出	卷云	红色,橘红色,橘色	中到大烧	密卷云
- 2025-06-27	日落	高积云,高层云,卷云,云砧	橘色,橘红色,红色	中到大烧	红虹,降水线高层云,幡状高积云,曙暮光条
- 2025-06-30	日出	高积云,卷云	红色,橘红色,橘色,橘黄色	中到大烧	幡状高积云
- 2025-07-02	日出	卷云,卷层云	红色,橘红色,橘色	中到大烧	密卷云
- 2025-07-04	日落	卷云,卷层云	橘黄色,橘色,橘红色,红色	中到大烧

好的，没问题。如果我们需要一个最简单、最基础的计算方法来判断火烧云的可能性，我们可以抛开复杂的路径分析和物理推断，只依赖几个最核心、最容易获取的 GFS 变量。

这个方法可以被称为 **“火烧云黄金法则检查清单”**。它的目标不是精确预测，而是快速过滤掉明显不可能出现火烧云的天气，并找出有潜力的日子。

### 最基础的火烧云预测方法

这个方法基于一个核心原则：**日落/日出时，本地上空必须“高空有云，低空无云”**。

**所需 GFS 数据 (在日落/日出时刻):**

1.  **高空云量 (HCDC - High Cloud Cover)**
2.  **中空云量 (MCDC - Medium Cloud Cover)**
3.  **低空云量 (LCDC - Low Cloud Cover)**
4.  **总降水量 (APCP - Total Precipitation)**

**计算/判断步骤:**

这个方法可以简化为一个三步决策流程：

---

#### **第 1 步：检查“杀手条件” (Veto Conditions)**

这是最重要的一步，如果满足以下任何一个条件，直接判定为 **“无火烧云”**，概率极低。

*   **条件A (低云遮蔽):** `低空云量 (LCDC)` > **60%**
    *   **理由:** 大面积的低空云会像一床棉被，完全挡住从地平线射来的光线，无论高空云层多完美，光也上不去。

*   **条件B (天气恶劣):** `总降水量 (APCP)` > **0 mm/hr**
    *   **理由:** 正在下雨或下雪，意味着天空被厚重的降水云系（如雨层云、积雨云）覆盖，这些云层厚实且不透光。

**如果通过了第 1 步，说明没有明显的“一票否决”项，我们继续第 2 步。**

---

#### **第 2 步：检查“画布条件” (Canvas Conditions)**

现在我们需要确认天上有没有用来“画画”的画布——也就是中高空云。

*   **计算“画布云量”:** `Canvas_Cloud = (高空云量 (HCDC) + 中空云量 (MCDC)) / 2`
    *   我们取高云和中云的平均值，作为衡量“有效云量”的指标。

*   **条件C (画布太少):** `Canvas_Cloud` < **15%**
    *   **理由:** 如果高空和中空几乎万里无云，那么你最多只能看到一个彩色的天空（晚霞），但没有被点亮的、成形状的云，也就是没有“烧”起来的感觉。判定为 **“弱火烧云”或“仅有晚霞”**。

*   **条件D (画布太厚):** `Canvas_Cloud` > **90%**
    *   **理由:** 如果高、中云量接近完全覆盖，云层可能会连成一片，变得过于厚重和均匀，反而缺少纹理和层次感，导致天空整体偏暗。判定为 **“概率中等”，效果可能不佳**。

**如果 `Canvas_Cloud` 在 15% 到 90% 之间，说明具备了很好的画布条件，我们进入第 3 步。**

---

#### **第 3 步：分级与输出 (Grading)**

通过了前两步，说明有很大的潜力。现在我们可以根据云量的组合给出一个简单的评级。

*   **黄金组合 (★★★★★ - 极佳):**
    *   `低空云量 (LCDC)` < 20%
    *   `画布云量 (Canvas_Cloud)` 在 **30% - 70%** 之间。
    *   **解读:** 低空极其通透，高空有恰到好处、疏密有致的云层。这是最理想的火烧云条件。

*   **白银组合 (★★★★☆ - 很好):**
    *   `低空云量 (LCDC)` 在 20% - 40% 之间。
    *   `画布云量 (Canvas_Cloud)` 在 **20% - 80%** 之间。
    *   **解读:** 低空可能有一些零散的云，但基本不构成阻挡。高空云量也很好，很有可能出现壮观景象。

*   **青铜组合 (★★★☆☆ - 一般/有机会):**
    *   `低空云量 (LCDC)` 在 40% - 60% 之间。
    *   `画布云量 (Canvas_Cloud)` 在 **15% - 90%** 之间。
    *   **解读:** 有一定概率。低空云量是个威胁，需要运气好，这些低云正好不在关键的日落/日出方向上。高空条件尚可。值得出门碰碰运气。

---

### 总结：最简流程图

```
开始
 |
 V
获取日落/日出时 GFS 数据 (HCDC, MCDC, LCDC, APCP)
 |
 V
[第1步]
(LCDC > 60%) 或 (APCP > 0) ?
 |
 +-- 是 --> 输出: "无火烧云 (概率低)" --> 结束
 |
 +-- 否 --> 继续
             |
             V
             [第2步]
             计算 Canvas_Cloud = (HCDC + MCDC) / 2
             |
             +-- Canvas_Cloud < 15% --> 输出: "仅有晚霞 (弱)" --> 结束
             |
             +-- Canvas_Cloud > 90% --> 输出: "多云天色 (中等)" --> 结束
             |
             +-- 否则 (15% <= Canvas_Cloud <= 90%) --> 继续
                                                       |
                                                       V
                                                       [第3步]
                                                       根据 LCDC 和 Canvas_Cloud 的具体值
                                                       进行“极佳/很好/一般”分级输出 --> 结束
```

这个方法简单、直观，并且抓住了最关键的几个因素，非常适合作为火烧云预测的入门基础模型。你只需要获取4个变量，通过几个简单的 `if-else` 判断，就能得出一个相当有参考价值的结论。